version: 2.1
workflows:
  version: 2
  just_push_pr:
    jobs:
      - pantheon/push:
          checkout: false
          terminus_clone_env: dev
          pre-steps:
            - checkout
            - run: composer -n install --optimize-autoloader --ignore-platform-reqs --no-dev
            - run: composer prepare-for-pantheon
          post-steps:
            - slack/notify:
                channel: gatsby-theme
                color: '#fc7703'
                message: 'Changes of ${CIRCLE_PULL_REQUEST} available on ${MULTIDEV_SITE_URL}'
          filters:
              branches:
                ignore:
                  - master
orbs:
  pantheon: pantheon-systems/pantheon@0.5.1
  slack: circleci/slack@3.4.2